{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load humanize %}
{% load cart_template_tags %}

{% block title %}Checkout {% endblock %}

{% block content %}
 <!-- Heading -->
<h2 class="my-5 h2 text-center">Checkout form</h2>
<!--Grid row-->
<div class="row">
    <!--Grid column-->
    <div class="col-md-8 mb-4">
        <!--Card-->
        <div class="card">
            <form class="card-body mb-form" method="POST">
                {% csrf_token %}
                {{ form|crispy }}
                <button class="btn btn-primary" type="submit">Checkout</button>
            </form>
        </div>
    </div>
    <!--Grid column-->

    <!--Grid column-->
    <div class="col-md-4 mb-4">
        <!-- Heading -->
        <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-muted">Your cart</span>
            <span class="badge badge-secondary badge-pill">{{ item_count }}</span>
        </h4>

    <!-- Cart -->
    <ul class="list-group mb-3 z-depth-1">
    {% for order_item in cart_items %}
        <li class="list-group-item d-flex justify-content-between lh-condensed">
            <div>
                <h6 class="my-0">{{ order_item.product.product_name }}</h6>
                <small class="text-muted">Quantity: {{ order_item.quantity }}</small>
            </div>
            <span class="text-muted">${{ order_item.product.price | cart_subtotal:order_item.quantity|intcomma }}</span>
        </li>
    {% endfor %}

    <li class="list-group-item d-flex justify-content-between">
        <strong>Total (USD)</strong>
        <strong>${{ total|intcomma }}</strong>
    </li>
    </ul>
    <!-- Cart -->

    <!-- Promo code -->
    <form class="card p-2">
        <div class="input-group">
            <input type="text" class="form-control" placeholder="Promo code" aria-label="Recipient's username" aria-describedby="basic-addon2">
            <div class="input-group-append">
                <button class="btn btn-secondary btn-md waves-effect m-0" type="button">Redeem</button>
            </div>
        </div>
    </form>
    <!-- Promo code -->

    </div>
    <!--Grid column-->

    </div>
    <!--Grid row-->
{% endblock %}